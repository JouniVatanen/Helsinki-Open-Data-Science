```{r, include = F}
# setup
knitr::opts_chunk$set(echo = F, comment = NA)
```

Multiple Correspondence analysis
========================================================
type: prompt
incremental: false
autosize: true

<font size=6>

- Dimensionality reduction method
- Analyses the pattern of relationships of several categorical
variables
- Generalization of PCA and a extension of correspondence analysis (CA)
- Deals with categorical variables, but continuous ones can be used as background (sublimentary) variables

</font>

Multiple Correspondence analysis
========================================================
incremental: false
autosize: true

<font size=6>

- In the analysis, you can either use the [indicator or the Burt matrix](https://en.wikipedia.org/wiki/Multiple_correspondence_analysis#As_an_extension_of_correspondences_analysis). 
- t채st채 jotain lis채채 ? yhteys CA:han ?
- ...

- And next, let's look how the MCA outputs look in R!

</font>

MCA summary
========================================================
incremental: false
autosize: true
left: 40%

<font size=5>

Output of summary contains...

- **Eigenvalues**: the variances and the percentage of variances retained by each dimension
- **Individuals**: the individuals coordinates, the contribution (ctr) and the cos2 (cosini squared, quality of representation) on the first two dimensions.

</font>

***

<font size=4>

```{r, echo=FALSE}
library(FactoMineR)
tea_time <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/tea_time.csv", sep  =",", header = T)
data <- dplyr::select(tea_time, dplyr::one_of(c('Tea', 'lunch', 'sugar')))
colnames(data)<- c('Var1', 'Var2', 'Var3')
levels(data$Var1) <-c("Label1", "Label2", "Label3")
levels(data$Var2) <-c("Level1", "Level2")
levels(data$Var3) <-c("Name1", "Name2")

res.mca <- MCA(data, graph = FALSE, method = 'indicator')
summary(res.mca, nbelements = 3)

```

</font>

MCA summary(2)
========================================================
incremental: false
autosize: true
left: 40%

<font size=5>

Output of summary contains...

- **Categories**: the coordinates of the variable categories, the contribution (ctr), the cosini squared and v.test value. The v.test follows normal distribution: if the value is below/above $\pm$ 1.96, the coordinate is significantly different from zero.
- **Categorical variables**: the squared correlation between each variable and the dimensions. If the value is close to one it indicates a strong link with the variable and dimension.

</font>

***

<font size=4>

```{r, echo=FALSE}
summary(res.mca, nbelements = 3)
```

[Read more](http://www.sthda.com/english/wiki/multiple-correspondence-analysis-essentials-interpretation-and-application-to-investigate-the-associations-between-categories-of-multiple-qualitative-variables-r-software-and-data-mining)

</font>


MCA plot(1)
========================================================
incremental: false
autosize: true
left: 65%

<font size=6>

MCA plot:
- You can plot for variables, individuals and background (sublimentary variables) separately or you can draw them in the same plot. 
- `plot.MCA()` function in R (from FactoMineR) has a lot of options for plotting
- Let's see a minimal example

See a [video](https://www.youtube.com/watch?v=reG8Y9ZgcaQ) of MCA (plotting options start at 5:36).

</font>

MCA plot(2)
========================================================
incremental: false
autosize: true
left: 65%

<font size=6>

- On the right we have MCA factor map, where are variables drawn on the first two dimensions
    - On the plot you can see correlations of the variables and the dimensions (The squared correlations of variables and dimensions are the coordinates)
    - The distance between column points gives a measure of their similarity
    - For example Label3 correlates with 2. dimension, but Level2 has little effect on either of the dimensions. Label2 and Name2 are more similar than Label2 and Level2.

</font>

***

```{r}
plot(res.mca, invisible=c("ind"), habillage = "quali", cex = 1.3)
```

[Read more](http://factominer.free.fr/classical-methods/multiple-correspondence-analysis.html)
